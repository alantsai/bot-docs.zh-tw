---
title: Bot Framework 中識別碼的指南 | Microsoft Docs
description: 本指南說明出現在 Bot Framework v3 通訊協定中的識別碼欄位特性。
keywords: 識別碼, bots, 通訊協定
author: RobStand
ms.author: kamrani
manager: kamrani
ms.topic: article
ms.service: bot-service
ms.subservice: sdk
ms.date: 04/30/2019
ms.openlocfilehash: 28932ca45c6faaad2f17ecc03f026ba04352a5a1
ms.sourcegitcommit: f84b56beecd41debe6baf056e98332f20b646bda
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/03/2019
ms.locfileid: "65033066"
---
# <a name="id-fields-in-the-bot-framework"></a>Bot Framework 中的識別碼欄位

本指南說明 Bot Framework 中的識別碼欄位特性。

## <a name="channel-id"></a>通道識別碼

每個 Bot Framework 通道都會有可供識別的唯一識別碼。

範例： `"channelId": "skype"`

通道識別碼可作為其他識別碼的命名空間。 Bot Framework 通訊協定中的執行階段呼叫必須在通道的內容中進行；通道會為通訊時所使用的對話和帳戶識別碼提供意義。

依照慣例，所有通道識別碼都是小寫字母。 通道會保證它們所發出的通道識別碼有一致的大小寫，因此，Bot 可以使用序數比較來確定相等性。

### <a name="rules-for-channel-ids"></a>通道識別碼的規則

- 通道識別碼會區分大小寫。

## <a name="bot-handle"></a>Bot 控制代碼

每個已向 Azure Bot Service 註冊的 Bot 都有一個 Bot 控制代碼。

範例： `FooBot`

Bot 控制代碼代表 Bot 已向線上 Azure Bot Service 進行註冊。 這項註冊會與 HTTP Webhook 端點以及通道註冊相關聯。

Azure Bot Service 可確保 Bot 控制代碼的唯一性。 Azure 入口網站會執行不區分大小寫的唯一性檢查 (亦即會將各種大小寫有所變化的 Bot 控制代碼視為單一控制代碼)，不過，這是 Azure 入口網站的特性，而不一定是 Bot 控制代碼本身的特性。

### <a name="rules-for-bot-handles"></a>Bot 控制代碼的規則

* Bot Framework 內的 Bot 控制代碼都是唯一的 (不區分大小寫)。

## <a name="app-id"></a>應用程式識別碼

每個已向 Azure Bot Service 註冊的 Bot 都有一個應用程式識別碼。

> [!NOTE]
> 過去，應用程式通常稱為「MSA 應用程式」或「MSA/AAD 應用程式」。 現在，應用程式更常簡稱為「應用程式」，但某些通訊協定元素可能會一直將應用程式稱為「MSA 應用程式」。

範例： `"msaAppId": "353826a6-4557-45f8-8d88-6aa0526b8f77"`

一個應用程式代表在身分識別小組應用程式入口網站中的一個註冊，並可作為 Bot Framework 執行階段通訊協定內的服務對服務身分識別機制。 應用程式可能有其他非 Bot 關聯，例如網站和行動/傳統型應用程式。

每個已註冊的 Bot 只會有一個應用程式。 雖然 Bot 擁有者無法獨立變更與其 Bot 相關聯的應用程式，但 Bot Framework 小組可以在少數例外狀況中這麼做。

Bot 和通道可能會使用應用程式識別碼來唯一識別已註冊的 Bot。

應用程式識別碼保證會是 GUID。 在比較應用程式識別碼時，不應該區分大小寫。

### <a name="rules-for-app-ids"></a>應用程式識別碼的規則

* 在 Microsoft 應用程式平台內，應用程式識別碼是唯一的 (GUID 比較)。
* 每個 Bot 都只有一個對應的應用程式。
* 變更 Bot 所關聯的應用程式需要 Bot Framework 小組的協助。

## <a name="channel-account"></a>通道帳戶

每個 Bot 和使用者在每個通道內都有一個帳戶。 帳戶中會包含識別碼 (`id`) 和其他參考性 Bot 非結構化資料，例如選擇性的名稱。

範例： `"from": { "id": "john.doe@contoso.com", "name": "John Doe" }`

此帳戶會描述通道內的地址，訊息可在其中傳送和接收。 在某些情況下，這些註冊存在於單一服務內 (例如 Skype、Facebook)。 在其他情況中，這些註冊會註冊於許多系統 (電子郵件地址、電話號碼)。 在更匿名的通道中 (例如，網路聊天)，註冊可能是暫時性的。

通道帳戶會以巢狀方式存在於通道內。 例如，Facebook 帳戶只是數字。 這個數字在其他通道中可能會有不同的意義，而在所有通道外則沒有意義。

通道帳戶和使用者 (實際人員) 之間的關聯性，取決於與每個通道相關聯的慣例。 例如，簡訊號碼通常會指涉某個人員一段時間，之後該號碼可能會轉移給其他人。 相反地，Facebook 帳戶通常會永久指涉某個人員，不過，兩個人共用 Facebook 帳戶的情況也不罕見。

在大部分通道中，您可以將通道帳戶視為一種可遞送訊息的信箱。 大部分通道一般都允許將多個地址對應至單一信箱；例如，jdoe@contoso.com 和 john.doe@service.contoso.com 可能會解析成相同收件匣。 某些通道會更進一步，根據對它進行存取的 Bot 來變更帳戶的地址；例如，Skype 及 Facebook 會改變使用者識別碼，讓每個 Bot 有不同的訊息收送地址。

雖然您可以在某些情況下，於地址之間確定相等性，但若要在信箱之間確定相等性以及在不同人之間確定相等性，則必須了解通道內的慣例，在許多情況下，您無法做到這一點。

透過傳送給 Bot 的活動上所存在的 `recipient` 欄位，Bot 會得知其通道帳戶地址。

### <a name="rules-for-channel-accounts"></a>通道帳戶的規則

* 通道帳戶在相關聯的通道內才會有意義。
* 多個識別碼可能會解析成相同帳戶。
* 可能會使用序數比較來確定兩個識別碼是否相同。
* 通常沒有比較可用來識別兩個不同的識別碼是否會解析成相同的帳戶、Bot 或人員。
* 識別碼、帳戶、信箱和人員之間的關聯性是否穩定，會取決於通道。

## <a name="conversation-id"></a>對話識別碼

訊息會在對話的內容中傳送及接收，而對話可由識別碼來識別。

範例： `"conversation": { "id": "1234" }`

對話會交換訊息和其他活動。 每個對話都有零個以上的活動，而且每個活動只會出現在一個對話中。 對話可能是永久的，也可能有不同的開始和結束。 建立、修改或結束對話的程序發生於通道內 (亦即，對話會在通道察覺時存在)，而且這些程序的特性會由通道確定。

對話內的活動是由使用者和 Bot 傳送的。 使用者「參與」對話的定義會隨通道而異，而且理論上，可能會包括目前的使用者、不斷收到訊息的使用者，以及傳送訊息的使用者。

數個通道 (例如，簡訊、Skype 以及其他可能項目) 習慣將指派給 1 對 1 對話的對話識別碼當作是遠端通道帳戶識別碼。 這個習慣有兩個副作用：
1. 對話識別碼是由檢視識別碼的人主觀認定的。 如果參與者 A 和 B 正在談話，參與者 A 所看到的對話識別碼是 "B"，參與者 B 所看到的對話識別碼是 "A"。
2. 如果 Bot 在此通道內有多個通道帳戶 (例如，如果 Bot 有兩個簡訊號碼)，則對話識別碼並不足以唯一識別 Bot 觀點內的對話。

因此，對話識別碼不一定能唯一識別通道內的單一對話，即便只有單一 Bot 也是如此。

### <a name="rules-for-conversation-ids"></a>對話識別碼的規則

* 對話在相關聯的通道內才會有意義。
* 多個識別碼可能會解析成相同對話。
* 序數相等不一定能確定兩個對話識別碼是相同的對話，不過大多數時候會是相同的。

## <a name="activity-id"></a>活動識別碼

活動會在 Bot Framework 通訊協定內傳送及接收，有時您可以識別這些活動。

範例： `"id": "5678"`

活動識別碼是選擇性的，通道會採用活動識別碼讓 Bot 有辦法在後續 API 呼叫中參照識別碼 (如果可供使用)：
* 回覆特定活動
* 查詢活動層級的參與者清單

由於尚未再建立任何使用案例，所以活動識別碼的處理方式沒有任何其他規則。
